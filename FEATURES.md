# 企業氣候數據儀表板 - 功能詳解

## 📊 核心功能

### 1. 狀態節點追蹤器 (Node Tracker)

**作用**：以視覺化方式展示企業在各個氣候指標上的狀態

**特點**：
- ✨ 圓形節點代表不同狀態選項
- 🎨 活躍狀態用實心有色圓圈表示
- ⚪ 非活躍選項顯示為淺灰色空心圓圈
- 🖱️ 支持鼠標點擊選擇
- ⌨️ 支持鍵盤導航（Tab、Enter、Space）
- 📱 完全響應式設計

**示例**：
```html
<div class="node-tracker" data-metric="net-zero-status">
    <div class="node" data-value="no">無承諾</div>
    <div class="node active" data-value="pledged">承諾</div>
    <div class="node" data-value="achieved">已達成</div>
</div>
```

**交互結果**：
- 點擊節點時，將高亮顯示為該部分的顏色
- 派發 `nodeSelected` 事件，包含指標名稱和選中值
- 控制台記錄選擇以便調試

---

### 2. 分類導航 (Category Navigation)

**作用**：快速導航到儀表板的不同部分

**特點**：
- 🎯 5個主要分類按鈕
- 📍 滾動時自動高亮當前分類
- 🔄 平滑滾動到目標部分
- 🎨 按鈕帶有分類特定顏色

**分類及顏色**：
1. **承諾目標** - 藍色 (#0066CC)
2. **排放披露** - 紫色 (#7030A0)
3. **能源再生** - 綠色 (#00B050)
4. **績效指標** - 橙色 (#FF8C00)
5. **策略行動** - 粉紅色 (#E81B23)

**使用方式**：
- 點擊任何分類按鈕會平滑滾動到該部分
- 頁面加載時自動檢測當前部分並高亮導航

---

### 3. 值顯示 (Value Display)

**作用**：展示具體的數值、年份和指標結果

**特點**：
- 📈 支持多個並排的值展示
- 🏷️ 帶有單位標籤
- 🎨 視覺突出的徽章樣式
- 💡 可選的說明文字

**組件類型**：
- `value-badge`：主要值顯示
- `value-badge.large`：大型值顯示
- `value-badge.highlight`：強調值（綠色）
- `value-note`：灰色說明文字
- `.unit`：單位文本

**示例**：
```html
<div class="value-display">
    <span class="value-badge">2050年</span>
    <span class="value-badge highlight">30%減量</span>
    <span class="value-note">（基準年：2022年）</span>
</div>
```

---

### 4. 圖表與趨勢可視化

**實現的圖表類型**：

#### 4.1 Sparkline（迷你趨勢圖）
用於展示3-5個數據點的緊湊趨勢
- 支持自定義顏色
- 自動縮放以適應容器
- 帶有漸變背景
- 顯示數據點標記

**應用場景**：能源消耗趨勢、年度排放量趨勢

#### 4.2 SimpleBarChart（簡單條形圖）
水平條形圖，用於比較多個值
- 自動計算相對比例
- 支持多色配置
- 響應式寬度
- 顯示實際值

**應用場景**：營收趨勢、能源構成

#### 4.3 SimplePieChart（簡單餅圖）
圓形圖，用於展示部分與整體的比例
- SVG 渲染，清晰無損
- 自動計算切片角度
- 支持多色配置

**應用場景**：能源使用構成、排放來源分布

#### 4.4 DataTable（數據表格）
結構化的表格展示
- 自動生成表頭
- 斑馬紋行顏色
- 懸停行高亮

#### 4.5 ProgressBar（進度條）
視覺進度指示器
- 支持百分比標籤
- 可自定義顏色
- 流暢的填充動畫

#### 4.6 StatusTimeline（狀態時間線）
垂直時間線，用於展示進展歷程
- 彩色節點標記
- 連接線
- 支持年份和描述文本

---

### 5. 展開式文本 (Expandable Text)

**作用**：在有限空間中展示冗長的描述，支持展開/收起

**特點**：
- 📖 默認最多顯示3行
- 👇 底部漸變指示更多內容
- 🔼 點擊展開按鈕顯示完整內容
- ✨ 平滑的高度過渡動畫

**應用場景**：關鍵減量策略說明、詳細行動描述

**標記方式**：
```html
<div class="text-description expandable">
    <p>策略文本...</p>
    <button class="expand-btn">展開全文</button>
</div>
```

---

### 6. 幫助提示 (Help Tooltips)

**作用**：為複雜概念提供詳細說明

**特點**：
- ℹ️ 小圓形圖標，提示有額外信息
- 🎯 懸停時顯示完整說明
- ♿ 完全無障礙（支持屏幕閱讀器）
- ⌨️ 可通過鍵盤訪問

**實現方式**：
```html
<button class="help-icon" title="企業是否承諾淨零排放">ⓘ</button>
```

HTML 的 `title` 屬性自動成為工具提示。

---

### 7. 年份篩選 (Year Filter)

**作用**：選擇不同年度查看數據（準備就緒）

**特點**：
- 📅 下拉選單
- 🔄 支持2022-2024年數據
- 📊 選擇時自動加載對應年度數據

**當前狀態**：UI 已完成，數據加載待 Phase 5

---

### 8. 下載功能 (Download)

**作用**：導出企業氣候數據（準備就緒）

**特點**：
- ⬇️ 突出的下載按鈕
- 📄 支持多種格式（待實現：CSV、PDF）
- 🔐 保留敏感信息控制

**當前狀態**：UI 已完成，導出功能待實現

---

### 9. 響應式設計

**支持的屏幕尺寸**：

| 設備類型 | 寬度範圍 | 特點 |
|---------|--------|------|
| 桌面 | 1200px+ | 完整佈局，並排組件 |
| 平板 | 768-1199px | 調整間距，適配寬度 |
| 手機 | <768px | 單列佈局，觸摸優化 |

**響應式特性**：
- 流動的網格佈局
- 重新排列的導航
- 優化的觸摸區域
- 調整的字體和間距

---

### 10. 無障礙性功能

**WCAG 2.1 AA 合規**：

✅ 語義化 HTML
- 正確的標題層級 (h1, h2, h3)
- 語義元素 (section, nav, main)
- 表單標籤與輸入關聯

✅ 鍵盤導航
- Tab 鍵在所有交互元素中循環
- Enter/Space 激活按鈕
- 合理的 tab 順序

✅ 屏幕閱讀器支持
- ARIA 標籤和角色
- 有意義的按鈕文本
- 適當的標題標記

✅ 視覺無障礙
- 高對比度顏色（AA 標準）
- 不依賴顏色傳達信息
- 清晰的焦點指示器

✅ 動作無障礙
- 尊重 `prefers-reduced-motion`
- 可選的自動動畫
- 關鍵動畫保留，裝飾動畫移除

---

## 🎨 視覺設計系統

### 顏色系統

**主色調**（按部分）：
```
承諾目標: #0066CC (藍色)
排放披露: #7030A0 (紫色)
能源再生: #00B050 (綠色)
績效指標: #FF8C00 (橙色)
策略行動: #E81B23 (粉紅色)
```

**中立色**：
```
深灰色: #333333 (文本)
中灰色: #666666 (次要文本)
淺灰色: #DCDCDC (邊框)
超淺灰色: #F5F5F5 (背景)
白色: #FFFFFF
```

### 排版

**字體堆棧**：
```
系統字體 (自動適配操作系統)
備用：-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial
```

**字體大小層級**：
- 小標籤: 12px
- 正文: 14px
- 中等: 16px
- 大: 18px
- 小標題: 20px
- 標題: 24px
- 大標題: 28px
- 超大: 32px

### 間距系統

基礎單位：8px

```
超小: 4px   (1/2 單位)
小: 8px     (1 單位)
中: 16px    (2 單位)
大: 24px    (3 單位)
超大: 32px  (4 單位)
巨大: 40px  (5 單位)
```

---

## ⚡ 性能優化

### 已實現的優化：

✅ **CSS 變量**
- 減少代碼重複
- 易於主題更改
- 更好的瀏覽器支持

✅ **事件委託**
- 減少事件監聽器數量
- 更好的內存使用

✅ **Debounce 函數**
- 優化滾動性能
- 減少不必要的重新計算

✅ **異步圖表加載**
- 防止阻塞主線程
- 漸進式增強

✅ **最小化 DOM 操作**
- 批量更新
- 減少回流和重繪

---

## 🔄 交互流程

### 典型用戶流程：

1. **頁面加載**
   - 應用所有樣式
   - 初始化 JavaScript 模塊
   - 渲染圖表

2. **瀏覽儀表板**
   - 用戶向下滾動查看不同部分
   - 導航自動高亮當前部分

3. **選擇狀態**
   - 用戶點擊節點
   - 節點高亮為部分的顏色
   - 事件被記錄（未來用於分析）

4. **查看詳細信息**
   - 用戶點擊幫助圖標查看說明
   - 用戶點擊展開按鈕查看完整策略

5. **比較不同年份**
   - 用戶從年份篩選器選擇年份
   - 所有數據刷新為該年份數據

6. **導出數據**
   - 用戶點擊下載按鈕
   - 數據以選定格式導出

---

## 🐛 故障排除

### 常見問題：

**Q：節點不可點擊？**
A：檢查瀏覽器開發者工具中是否有 JavaScript 錯誤。確保 script.js 已加載。

**Q：圖表不顯示？**
A：檢查是否已加載 charts.js。在控制台查看是否有 SVG 相關錯誤。

**Q：樣式不正確？**
A：清除瀏覽器緩存或使用隱私/無痕模式加載頁面。檢查 styles.css 路徑。

**Q：在手機上不響應式？**
A：檢查 HTML 頭部的 viewport meta 標籤。某些移動瀏覽器可能需要硬刷新。

---

## 📚 更多資源

- **plan.md**：詳細的設計計畫和數據映射
- **README.md**：項目概述和快速入門
- **script.js**：交互功能的源代碼
- **styles.css**：所有樣式定義和變量
- **charts.js**：圖表組件的實現

---

**最後更新**：2025年11月14日
